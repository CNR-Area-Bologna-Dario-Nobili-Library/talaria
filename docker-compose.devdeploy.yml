version: '3.4'


services:

  traefik:
    ports:
    - 80:80
    - 443:443
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock:ro
    - ./docker/traefik:/etc/traefik

  frontend:
    build: ./frontend_test
    expose:
    - 3000
    restart: always
    labels:
    - "traefik.port=3000"
    - "traefik.enable=true"
    - "traefik.frontend.rule=Host:${FRONTEND_DOMAIN},www.${FRONTEND_DOMAIN}"
    - "traefik.docker.network=proxy"

  phpmyadmin:
    labels:
    - "traefik.http.middlewares.test-auth.basicauth.users=${PMA_AUTH}"
#    - "traefik.enable=false"
